<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mercado Extrações</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header>
        <div class="header-container">
            <div class="header-top">
                <a href="/" class="logo-link">
                    <div class="logo-circle">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4 16L12 21L20 16M4 8L12 13L20 8M12 3L4 8L12 13L20 8L12 3Z" stroke="#FFE600"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                    </div>
                    <span class="logo-text">mercado extrações</span>
                </a>
                <div class="header-meta">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                        <circle cx="12" cy="10" r="3"></circle>
                    </svg>
                    <span>Extraindo para: <strong>Loja de Produtos</strong></span>
                </div>
            </div>
        </div>
    </header>

    <div class="main-wrapper">
        <div class="card">
            <div class="tabs-container">
                <div class="tabs">
                    <button class="tab-btn active" data-target="single">Individual</button>
                    <button class="tab-btn" data-target="batch">Em Lote / Arquivo</button>
                </div>
            </div>

            <!-- Single Content -->
            <div id="tab-single" class="tab-content active">
                <div class="search-container-vibrant">
                    <h2 class="section-title">Extrair Produto Individual</h2>
                    <p class="section-subtitle">Cole o link do Mercado Livre abaixo para processar imediatamente.</p>

                    <form id="scrape-form" class="vibrant-search-box">
                        <input type="url" id="url-input" placeholder="https://produto.mercadolivre.com.br/..." required
                            autocomplete="off">
                        <button type="submit" id="submit-btn" class="btn-blue">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="11" cy="11" r="8"></circle>
                                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                            </svg>
                            Extrair Agora
                        </button>
                    </form>
                    <p class="search-hint">Iremos capturar título, descrição e todas as características técnicas.</p>
                </div>
            </div>

            <!-- Batch Content -->
            <div id="tab-batch" class="tab-content">
                <div class="upload-section">
                    <h2 class="upload-title">Processar em Lote</h2>
                    <p class="upload-subtitle">Selecione uma planilha (XLSX ou CSV) contendo os links.</p>

                    <div class="dropzone" id="dropzone">
                        <input type="file" id="file-input" accept=".csv, .xlsx, .xls" class="hidden">
                        <div class="dropzone-content">
                            <div class="upload-icon-circle">
                                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--color-blue)"
                                    stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="17 8 12 3 7 8"></polyline>
                                    <line x1="12" y1="3" x2="12" y2="15"></line>
                                </svg>
                            </div>
                            <h3>Toque para selecionar arquivos</h3>
                            <p>ou arraste e solte sua planilha aqui</p>
                            <button type="button" class="btn-outline-blue" id="browse-btn"
                                style="margin-top: 1rem;">Procurar Arquivo</button>
                        </div>

                        <div id="file-info" class="hidden file-selected-box">
                            <span id="file-name"></span>
                            <button type="button" id="remove-file-btn">&times;</button>
                        </div>
                    </div>

                    <button type="button" id="batch-submit-btn" class="btn-blue hidden">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="9" y1="3" x2="9" y2="21"></line>
                        </svg>
                        Iniciar Processamento Lote
                    </button>
                </div>
            </div>

            <!-- Common Loader -->
            <div id="loader" class="loader-container hidden">
                <div class="spinner"></div>
                <p id="loader-text">Extraindo dados...</p>
                <div id="progress-container" class="hidden"
                    style="width: 100%; height: 8px; background: #eee; border-radius: 4px; margin-top: 1rem; overflow: hidden;">
                    <div id="progress-bar"
                        style="height: 100%; width: 0%; background: var(--color-blue); transition: width 0.3s;"></div>
                </div>
            </div>

            <!-- Unified Results Area -->
            <div id="table-result-container" class="results-card hidden">
                <div class="results-header">
                    <div>
                        <h3 style="font-weight: 700;">Resultados Extraídos</h3>
                        <p id="batch-stats" style="font-size: 0.85rem; color: var(--color-text-light);"></p>
                    </div>
                    <button id="export-csv-btn" class="btn-success">Baixar CSV para Excel</button>
                </div>
                <div class="table-container">
                    <table id="results-table">
                        <thead id="results-thead">
                            <tr id="results-thead-row">
                                <th>Status</th>
                                <th>Produto</th>
                                <th>Descrição</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="results-tbody"></tbody>
                    </table>
                </div>
            </div>

            <div id="error-message" class="hidden"
                style="margin: 1rem; padding: 1rem; background: #feebeb; color: var(--color-error); border-radius: 8px; font-weight: 600; text-align: center;">
                <span id="error-text"></span>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>